<!DOCTYPE html>
<html>
  <head>
    <meta charset=utf-8 />
    <title>Delayed modal demo</title>
    <link href="css/colorbox.css" rel="stylesheet">
    <!--<link rel="stylesheet" href="https://cdn.rawgit.com/jackmoore/colorbox/master/example1/colorbox.css" />-->
    <link href="css/custom.css" rel="stylesheet">
  </head>
  <body>
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script src="js/jquery.colorbox-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.1.3/js.cookie.min.js"></script>

    <div>
      <h1 style="height:400px">Top Header </h1>
    </div>
    <div id="modal-mobile-content">
      <button href="#bottom" class="button order-cheezburger">Order Cheezburger</button>
    </div>
    <div id="modal-desktop-content">
      <button href="#bottom" class="button order-cheezburger">Order Cheezburger</button>
    </div>
    <div id="bottom">
      <h1 style="height:1000px">Bottom Header </h1>
    </div>

    <script>

      $(".order-cheezburger").on("click", function() {
        $.colorbox.close();
        window.location.replace('#bottom');
      });

      function onPopupMobileOpen() {
        $("#myInput").focus();
        $("#modal-mobile-content").show();
      }

      function onPopupMobileClose() {
        $("#modal-mobile-content").hide();
        Cookies.set('colorboxShown','yes', { expires: 1 });
        lastFocus.focus();
      }

      function onPopupDesktopOpen() {
        $("#myInput").focus();
        $("#modal-desktop-content").show();
      }

      function onPopupDesktopClose() {
        $("#modal-desktop-content").hide();
        Cookies.set('colorboxShown','yes', { expires: 1 });

      }

      function displayDesktopPopup(){
        $.colorbox({
          inline: true,
          href: "#modal-desktop-content",
          className: "cta",
          opacity: .4,
          width: "600px",
          height: "610px",
          onComplete: onPopupDesktopOpen,
          onClosed: onPopupDesktopClose
        });
      }

      function displayMobilePopup(){
        $.colorbox({
          inline: true,
          href: "#modal-mobile-content",
          className: "cta",
          opacity: .4,
          width: "320px",
          height: "450px",
          onComplete: onPopupMobileOpen,
          onClosed: onPopupMobileClose
        });
      }

      setTimeout(function(){
        var popupShown = Cookies.get('colorboxShown');

        if (popupShown){
          console.log("Cookie found. No action necessary");
        } else {
          lastFocus = document.activeElement;
          if (window.matchMedia("(min-width: 768px)").matches) {
            displayDesktopPopup();
          } else {
            displayMobilePopup();
          }
        }
      }, 2000);

    </script>



  </body>
</html>
